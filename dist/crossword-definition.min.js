/**
 * @license crossword-definition v1.0.0
 * (c) 2018 Finsi, Inc.
 */

!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s(e.crosswordDefinition={})}(this,function(e){"use strict";var s=function(){return function(e){this.light=!1,this.hint=!1,void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.crossword&&(this.crossword=e.crossword),void 0!=e.light&&(this.light=e.light),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.clueLabel&&(this.clueLabel=e.clueLabel),void 0!=e.acrossClue&&(this.acrossClue=e.acrossClue),void 0!=e.downClue&&(this.downClue=e.downClue),void 0!=e.acrossClueLetterIndex&&(this.acrossClueLetterIndex=e.acrossClueLetterIndex),void 0!=e.downClueLetterIndex&&(this.downClueLetterIndex=e.downClueLetterIndex),void 0!=e.hint&&(this.hint=e.hint)}}(),t=function(){return function(e){this.across=!1,this.cells=[],this.hints=[],void 0!=e.number&&(this.number=e.number),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.across&&(this.across=e.across),void 0!=e.clue&&(this.clue=e.clue),void 0!=e.hints&&(this.hints=e.hints),this.code=this.number+(this.across?"a":"d")}}(),i=function(){function e(e){if(this.acrossClues=[],this.downClues=[],this.width=e.width,this.height=e.height,this.matrix=this.buildMatrix(),void 0===this.width||null===this.width||this.width<0||void 0===this.height||null===this.height||this.height<0)throw new Error("[CrosswordDefinition] The crossword bounds are invalid.");for(var s=e.acrossClues.concat(e.downClues),i=0;i<s.length;i++){var r=s[i],o=i<e.acrossClues.length,n=new t({number:r.number,answer:r.answer,x:r.x-1,y:r.y-1,across:o,clue:r.clue,hints:r.hints}),h=n.x,a=n.y;if(this[o?"acrossClues":"downClues"].push(n),n.x<0||n.x>=this.width||n.y<0||n.y>=this.height)throw new Error("[CrosswordDefinition] Clue '"+n.answer+"' at ("+(n.x+1)+", "+(n.y+1)+") doesn't start in the bounds.");if(o){if(n.x+n.answer.length>this.width)throw new Error("[CrosswordDefinition] Clue '"+n.code+"' '"+n.answer+"' at ("+(n.x+1)+", "+(n.y+1)+") exceeds horizontal bounds, the clue needs a with of "+(n.answer.length+n.x)+" but the board has a width of "+this.width+".")}else if(n.y+n.answer.length>this.height)throw new Error("[CrosswordDefinition] Clue '"+n.code+"' '"+n.answer+"' at ("+(n.x+1)+", "+(n.y+1)+") exceeds vertical bounds, the clue needs a height of "+(n.answer.length+n.y)+" but the board has a height of "+this.height+".");for(var l=0;l<n.answer.length;l++){var u=this.matrix[a][h];if(u.answer){if(n.across&&u.acrossClue)throw new Error("[CrosswordDefinition] Across clue '"+n.code+"' '"+n.answer+"' at ("+(h+1)+", "+(a+1)+") is overlapping the existing clue '"+u.acrossClue.code+"' '"+u.acrossClue.answer+"' at ("+(u.acrossClue.x+1)+", "+(u.acrossClue.y+1)+")");if(!n.across&&u.downClue)throw new Error("[CrosswordDefinition] Down clue '"+n.code+"' '"+n.answer+"' at ("+(h+1)+", "+(a+1)+") is overlapping the existing clue '"+u.downClue.code+"' '"+u.downClue.answer+"' at ("+(u.downClue.x+1)+", "+(u.downClue.y+1)+")");if(u.answer.toLowerCase()!==n.answer[l].toLowerCase()){var d=u.acrossClue.answer.split(""),w=u.acrossClueLetterIndex,c=n.answer.split(""),C=l;throw d.splice(w,0,"["),d.splice(w+2,0,"]"),d=d.join(""),c.splice(C,0,"["),c.splice(C+2,0,"]"),c=c.join(""),new Error("[CrosswordDefinition] Clue '"+n.code+"' answer at ("+(h+1)+", "+(a+1)+") is not coherent with previous clue '"+u.acrossClue.code+"' at ("+(u.acrossClue.x+1)+", "+(u.acrossClue.y+1)+") answer. "+d+" doesn't match with "+c)}}if(0===l){if(u.clueLabel&&u.clueLabel!==n.number){var f=u.acrossClue||u.downClue;throw new Error("[CrosswordDefinition] Clue '"+n.code+"' ('"+n.answer+"') at ("+(h+1)+", "+(a+1)+") has a label which is inconsistent with another clue '"+u.acrossClue.code+"' ("+f.number+") with number'"+f.answer+"'. If two clues starts in the same cell, the 'number' option must be the same. In this case, "+f.number)}u.clueLabel=n.number}u.answer=n.answer[l],u.light=!0,u[o?"acrossClue":"downClue"]=n,u[o?"acrossClueLetterIndex":"downClueLetterIndex"]=l,n.cells.push(u),n.hints.length>0&&-1!=n.hints.indexOf(l+1)&&(u.hint=!0),o?h++:a++}}}return e.prototype.buildMatrix=function(){for(var e=this.width,t=this.height,i=[],r=0;r<t;r++){for(var o=[],n=0;n<e;n++)o[n]=new s({crossword:this,x:n,y:r});i[r]=o}return i},e.prototype.toString=function(){for(var e="",s=this.matrix,t=0,i=s.length;t<i;t++){var r=s[t];e+="\n";for(var o=0,n=r.length;o<n;o++){e+=r[o].answer||" "}}return e},e}();e.CrosswordCell=s,e.CrosswordClueDefinition=t,e.CrosswordDefinition=i,Object.defineProperty(e,"__esModule",{value:!0})});
