/**
 * @license crossword-definition v0.0.1
 * (c) 2018 Finsi, Inc.
 */

!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s(e.crosswordDefinition={})}(this,function(e){"use strict";var s=function(){return function(e){this.light=!1,this.hint=!1,void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.crossword&&(this.crossword=e.crossword),void 0!=e.light&&(this.light=e.light),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.clueLabel&&(this.clueLabel=e.clueLabel),void 0!=e.acrossClue&&(this.acrossClue=e.acrossClue),void 0!=e.downClue&&(this.downClue=e.downClue),void 0!=e.acrossClueLetterIndex&&(this.acrossClueLetterIndex=e.acrossClueLetterIndex),void 0!=e.hint&&(this.hint=e.hint)}}(),i=function(){return function(e){this.across=!1,this.cells=[],this.hints=[],void 0!=e.number&&(this.number=e.number),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.across&&(this.across=e.across),void 0!=e.clue&&(this.clue=e.clue),void 0!=e.cells&&(this.cells=e.cells),void 0!=e.hints&&(this.hints=e.hints),this.code=this.number+(this.across?"a":"d")}}(),t=function(){function e(e){if(this.acrossClues=[],this.downClues=[],this.width=e.width,this.height=e.height,this.matrix=this.buildMatrix(),void 0===this.width||null===this.width||this.width<0||void 0===this.height||null===this.height||this.height<0)throw new Error("[CrosswordDefinition] The crossword bounds are invalid.");for(var s=e.acrossClues.concat(e.downClues),t=0;t<s.length;t++){var r=s[t],o=t<e.acrossClues.length,n=new i({number:r.number,answer:r.answer,x:r.x-1,y:r.y-1,across:o,clue:r.clue,cells:[],hints:r.hints});if(this[o?"acrossClues":"downClues"].push(n),n.x<0||n.x>=this.width||n.y<0||n.y>=this.height)throw new Error("[CrosswordDefinition] Clue "+n.code+" doesn't start in the bounds.");if(o){if(n.x+n.answer.length>this.width)throw new Error("[CrosswordDefinition] Clue at ("+n.x+","+n.y+") '"+n.answer+"' exceeds horizontal bounds, width of "+this.width+".")}else if(n.y+n.answer.length>this.height)throw new Error("[CrosswordDefinition] Clue at ("+n.x+","+n.y+") '"+n.answer+"' exceeds vertical bounds, height of "+this.height+".");for(var h=n.x,l=n.y,d=0;d<n.answer.length;d++){var a=this.matrix[l][h];if(a.light=!0,a[o?"acrossClue":"downClue"]=n,a[o?"acrossClueLetterIndex":"downClueLetterIndex"]=d,n.cells.push(a),n.hints.length>0&&-1!=n.hints.indexOf(d+1)&&(a.hint=!0),n.answer){if(void 0!==a.answer&&" "!==a.answer&&a.answer!==n.answer[d]){var u=a.acrossClue.answer.split(""),c=a.acrossClueLetterIndex,w=a.downClue.answer.split(""),f=a.downClueLetterIndex;throw u.splice(c,0,"["),u.splice(c+2,0,"]"),u=u.join(""),w.splice(f,0,"["),w.splice(f+2,0,"]"),w=w.join(""),new Error("[CrosswordDefinition] Clue "+n.code+" answer at ("+(h+1)+", "+(l+1)+") is not coherent with previous clue ("+a.acrossClue.code+") answer. "+u+" doesn't match with "+w)}a.answer=n.answer[d]}if(0===d){if(a.clueLabel&&a.clueLabel!==n.number)throw new Error("[CrosswordDefinition] Clue at ("+(h+1)+", "+(l+1)+") '"+n.answer+"' has a label which is inconsistent with another clue ("+a.acrossClue.code+").");a.clueLabel=n.number}o?h++:l++}}}return e.prototype.buildMatrix=function(){for(var e=this.width,i=this.height,t=[],r=0;r<i;r++){for(var o=[],n=0;n<e;n++)o[n]=new s({crossword:this,x:n,y:r});t[r]=o}return t},e.prototype.toString=function(){for(var e="",s=this.matrix,i=0,t=s.length;i<t;i++){var r=s[i];e+="\n";for(var o=0,n=r.length;o<n;o++){e+=r[o].answer||" "}}return e},e}();e.CrosswordCell=s,e.CrosswordClueDefinition=i,e.CrosswordDefinition=t,Object.defineProperty(e,"__esModule",{value:!0})});
