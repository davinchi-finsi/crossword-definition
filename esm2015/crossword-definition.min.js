/**
 * @license crossword-definition v0.0.1
 * (c) 2018 Finsi, Inc.
 */

!function(s,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(s.crosswordDefinition={})}(this,function(s){"use strict";class e{constructor(s){this.light=!1,this.hint=!1,void 0!=s.x&&(this.x=s.x),void 0!=s.y&&(this.y=s.y),void 0!=s.crossword&&(this.crossword=s.crossword),void 0!=s.light&&(this.light=s.light),void 0!=s.answer&&(this.answer=s.answer),void 0!=s.clueLabel&&(this.clueLabel=s.clueLabel),void 0!=s.acrossClue&&(this.acrossClue=s.acrossClue),void 0!=s.downClue&&(this.downClue=s.downClue),void 0!=s.acrossClueLetterIndex&&(this.acrossClueLetterIndex=s.acrossClueLetterIndex),void 0!=s.hint&&(this.hint=s.hint)}}class i{constructor(s){this.across=!1,this.cells=[],this.hints=[],void 0!=s.number&&(this.number=s.number),void 0!=s.answer&&(this.answer=s.answer),void 0!=s.x&&(this.x=s.x),void 0!=s.y&&(this.y=s.y),void 0!=s.across&&(this.across=s.across),void 0!=s.clue&&(this.clue=s.clue),void 0!=s.cells&&(this.cells=s.cells),void 0!=s.hints&&(this.hints=s.hints),this.code=this.number+(this.across?"a":"d")}}class t{constructor(s){if(this.acrossClues=[],this.downClues=[],this.width=s.width,this.height=s.height,this.matrix=this.buildMatrix(),void 0===this.width||null===this.width||this.width<0||void 0===this.height||null===this.height||this.height<0)throw new Error("[CrosswordDefinition] The crossword bounds are invalid.");let e=s.acrossClues.concat(s.downClues);for(let t=0;t<e.length;t++){let r=e[t],o=t<s.acrossClues.length,n=new i({number:r.number,answer:r.answer,x:r.x-1,y:r.y-1,across:o,clue:r.clue,cells:[],hints:r.hints});if(this[o?"acrossClues":"downClues"].push(n),n.x<0||n.x>=this.width||n.y<0||n.y>=this.height)throw new Error(`[CrosswordDefinition] Clue ${n.code} doesn't start in the bounds.`);if(o){if(n.x+n.answer.length>this.width)throw new Error(`[CrosswordDefinition] Clue at (${n.x},${n.y}) '${n.answer}' exceeds horizontal bounds, width of ${this.width}.`)}else if(n.y+n.answer.length>this.height)throw new Error(`[CrosswordDefinition] Clue at (${n.x},${n.y}) '${n.answer}' exceeds vertical bounds, height of ${this.height}.`);let h=n.x,l=n.y;for(let s=0;s<n.answer.length;s++){let e=this.matrix[l][h];if(e.light=!0,e[o?"acrossClue":"downClue"]=n,e[o?"acrossClueLetterIndex":"downClueLetterIndex"]=s,n.cells.push(e),n.hints.length>0&&-1!=n.hints.indexOf(s+1)&&(e.hint=!0),n.answer){if(void 0!==e.answer&&" "!==e.answer&&e.answer!==n.answer[s]){let s=e.acrossClue.answer.split(""),i=e.acrossClueLetterIndex,t=e.downClue.answer.split(""),r=e.downClueLetterIndex;throw s.splice(i,0,"["),s.splice(i+2,0,"]"),s=s.join(""),t.splice(r,0,"["),t.splice(r+2,0,"]"),t=t.join(""),new Error(`[CrosswordDefinition] Clue ${n.code} answer at (${h+1}, ${l+1}) is not coherent with previous clue (${e.acrossClue.code}) answer. ${s} doesn't match with ${t}`)}e.answer=n.answer[s]}if(0===s){if(e.clueLabel&&e.clueLabel!==n.number)throw new Error(`[CrosswordDefinition] Clue at (${h+1}, ${l+1}) '${n.answer}' has a label which is inconsistent with another clue (${e.acrossClue.code}).`);e.clueLabel=n.number}o?h++:l++}}}buildMatrix(){let s=this.width,i=this.height,t=[];for(let r=0;r<i;r++){let i=[];for(let t=0;t<s;t++)i[t]=new e({crossword:this,x:t,y:r});t[r]=i}return t}toString(){let s="",e=this.matrix;for(let i=0,t=e.length;i<t;i++){let t=e[i];s+="\n";for(let e=0,i=t.length;e<i;e++){let i=t[e];s+=i.answer||" "}}return s}}s.CrosswordCell=e,s.CrosswordClueDefinition=i,s.CrosswordDefinition=t,Object.defineProperty(s,"__esModule",{value:!0})});
