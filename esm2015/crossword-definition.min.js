/**
 * @license crossword-definition v0.0.1
 * (c) 2018 Finsi, Inc.
 */

!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s(e.crosswordDefinition={})}(this,function(e){"use strict";class s{constructor(e){this.light=!1,this.hint=!1,void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.crossword&&(this.crossword=e.crossword),void 0!=e.light&&(this.light=e.light),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.clueLabel&&(this.clueLabel=e.clueLabel),void 0!=e.acrossClue&&(this.acrossClue=e.acrossClue),void 0!=e.downClue&&(this.downClue=e.downClue),void 0!=e.acrossClueLetterIndex&&(this.acrossClueLetterIndex=e.acrossClueLetterIndex),void 0!=e.downClueLetterIndex&&(this.downClueLetterIndex=e.downClueLetterIndex),void 0!=e.hint&&(this.hint=e.hint)}}class i{constructor(e){this.across=!1,this.cells=[],this.hints=[],void 0!=e.number&&(this.number=e.number),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.across&&(this.across=e.across),void 0!=e.clue&&(this.clue=e.clue),void 0!=e.hints&&(this.hints=e.hints),this.code=this.number+(this.across?"a":"d")}}class t{constructor(e){if(this.acrossClues=[],this.downClues=[],this.width=e.width,this.height=e.height,this.matrix=this.buildMatrix(),void 0===this.width||null===this.width||this.width<0||void 0===this.height||null===this.height||this.height<0)throw new Error("[CrosswordDefinition] The crossword bounds are invalid.");let s=e.acrossClues.concat(e.downClues);for(let t=0;t<s.length;t++){let r=s[t],n=t<e.acrossClues.length,o=new i({number:r.number,answer:r.answer,x:r.x-1,y:r.y-1,across:n,clue:r.clue,hints:r.hints});if(this[n?"acrossClues":"downClues"].push(o),o.x<0||o.x>=this.width||o.y<0||o.y>=this.height)throw new Error(`[CrosswordDefinition] Clue ${o.code} doesn't start in the bounds.`);if(n){if(o.x+o.answer.length>this.width)throw new Error(`[CrosswordDefinition] Clue at (${o.x},${o.y}) '${o.answer}' exceeds horizontal bounds, width of ${this.width}.`)}else if(o.y+o.answer.length>this.height)throw new Error(`[CrosswordDefinition] Clue at (${o.x},${o.y}) '${o.answer}' exceeds vertical bounds, height of ${this.height}.`);let h=o.x,d=o.y;for(let e=0;e<o.answer.length;e++){let s=this.matrix[d][h];if(s.light=!0,s[n?"acrossClue":"downClue"]=o,s[n?"acrossClueLetterIndex":"downClueLetterIndex"]=e,o.cells.push(s),o.hints.length>0&&-1!=o.hints.indexOf(e+1)&&(s.hint=!0),o.answer){if(void 0!==s.answer&&" "!==s.answer&&s.answer!==o.answer[e]){let e=s.acrossClue.answer.split(""),i=s.acrossClueLetterIndex,t=s.downClue.answer.split(""),r=s.downClueLetterIndex;throw e.splice(i,0,"["),e.splice(i+2,0,"]"),e=e.join(""),t.splice(r,0,"["),t.splice(r+2,0,"]"),t=t.join(""),new Error(`[CrosswordDefinition] Clue ${o.code} answer at (${h+1}, ${d+1}) is not coherent with previous clue (${s.acrossClue.code}) answer. ${e} doesn't match with ${t}`)}s.answer=o.answer[e]}if(0===e){if(s.clueLabel&&s.clueLabel!==o.number){const e=s.acrossClue||s.downClue;throw new Error(`[CrosswordDefinition] Clue '${o.code}' ('${o.answer}') with number '${o.number}' at (${h+1}, ${d+1}) has a label which is inconsistent with another clue '${s.acrossClue.code}' (${e.number}) with number'${e.answer}'. If two clues starts in the same cell, the 'number' option must be the same. In this case, ${e.number}`)}s.clueLabel=o.number}n?h++:d++}}}buildMatrix(){let e=this.width,i=this.height,t=[];for(let r=0;r<i;r++){let i=[];for(let t=0;t<e;t++)i[t]=new s({crossword:this,x:t,y:r});t[r]=i}return t}toString(){let e="",s=this.matrix;for(let i=0,t=s.length;i<t;i++){let t=s[i];e+="\n";for(let s=0,i=t.length;s<i;s++){let i=t[s];e+=i.answer||" "}}return e}}e.CrosswordCell=s,e.CrosswordClueDefinition=i,e.CrosswordDefinition=t,Object.defineProperty(e,"__esModule",{value:!0})});
