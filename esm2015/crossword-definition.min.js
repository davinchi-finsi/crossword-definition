/**
 * @license crossword-definition v1.0.1
 * (c) 2018 Finsi, Inc.
 */

!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s(e.crosswordDefinition={})}(this,function(e){"use strict";class s{constructor(e){this.light=!1,this.hint=!1,void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.crossword&&(this.crossword=e.crossword),void 0!=e.light&&(this.light=e.light),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.clueLabel&&(this.clueLabel=e.clueLabel),void 0!=e.acrossClue&&(this.acrossClue=e.acrossClue),void 0!=e.downClue&&(this.downClue=e.downClue),void 0!=e.acrossClueLetterIndex&&(this.acrossClueLetterIndex=e.acrossClueLetterIndex),void 0!=e.downClueLetterIndex&&(this.downClueLetterIndex=e.downClueLetterIndex),void 0!=e.hint&&(this.hint=e.hint)}}class i{constructor(e){this.across=!1,this.cells=[],this.hints=[],void 0!=e.number&&(this.number=e.number),void 0!=e.answer&&(this.answer=e.answer),void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.across&&(this.across=e.across),void 0!=e.clue&&(this.clue=e.clue),void 0!=e.hints&&(this.hints=e.hints),this.code=this.number+(this.across?"a":"d")}}class t{constructor(e){if(this.acrossClues=[],this.downClues=[],this.width=e.width,this.height=e.height,this.matrix=this.buildMatrix(),void 0===this.width||null===this.width||this.width<0||void 0===this.height||null===this.height||this.height<0)throw new Error("[CrosswordDefinition] The crossword bounds are invalid.");let s=e.acrossClues.concat(e.downClues);for(let t=0;t<s.length;t++){let r=s[t],o=t<e.acrossClues.length,n=new i({number:r.number,answer:r.answer,x:r.x-1,y:r.y-1,across:o,clue:r.clue,hints:r.hints}),h=n.x,l=n.y;if(this[o?"acrossClues":"downClues"].push(n),n.x<0||n.x>=this.width||n.y<0||n.y>=this.height)throw new Error(`[CrosswordDefinition] Clue '${n.answer}' at (${n.x+1}, ${n.y+1}) doesn't start in the bounds.`);if(o){if(n.x+n.answer.length>this.width)throw new Error(`[CrosswordDefinition] Clue '${n.code}' '${n.answer}' at (${n.x+1}, ${n.y+1}) exceeds horizontal bounds, the clue needs a with of ${n.answer.length+n.x} but the board has a width of ${this.width}.`)}else if(n.y+n.answer.length>this.height)throw new Error(`[CrosswordDefinition] Clue '${n.code}' '${n.answer}' at (${n.x+1}, ${n.y+1}) exceeds vertical bounds, the clue needs a height of ${n.answer.length+n.y} but the board has a height of ${this.height}.`);for(let e=0;e<n.answer.length;e++){let s=this.matrix[l][h];if(s.answer){if(n.across&&s.acrossClue)throw new Error(`[CrosswordDefinition] Across clue '${n.code}' '${n.answer}' at (${h+1}, ${l+1}) is overlapping the existing clue '${s.acrossClue.code}' '${s.acrossClue.answer}' at (${s.acrossClue.x+1}, ${s.acrossClue.y+1})`);if(!n.across&&s.downClue)throw new Error(`[CrosswordDefinition] Down clue '${n.code}' '${n.answer}' at (${h+1}, ${l+1}) is overlapping the existing clue '${s.downClue.code}' '${s.downClue.answer}' at (${s.downClue.x+1}, ${s.downClue.y+1})`);if(s.answer.toLowerCase()!==n.answer[e].toLowerCase()){let i=s.acrossClue.answer.split(""),t=s.acrossClueLetterIndex,r=n.answer.split(""),o=e;throw i.splice(t,0,"["),i.splice(t+2,0,"]"),i=i.join(""),r.splice(o,0,"["),r.splice(o+2,0,"]"),r=r.join(""),new Error(`[CrosswordDefinition] Clue '${n.code}' answer at (${h+1}, ${l+1}) is not coherent with previous clue '${s.acrossClue.code}' at (${s.acrossClue.x+1}, ${s.acrossClue.y+1}) answer. ${i} doesn't match with ${r}`)}}if(0===e){if(s.clueLabel&&s.clueLabel!==n.number){const e=s.acrossClue||s.downClue;throw new Error(`[CrosswordDefinition] Clue '${n.code}' ('${n.answer}') at (${h+1}, ${l+1}) has a label which is inconsistent with another clue '${s.acrossClue.code}' (${e.number}) with number'${e.answer}'. If two clues starts in the same cell, the 'number' option must be the same. In this case, ${e.number}`)}s.clueLabel=n.number}s.answer=n.answer[e],s.light=!0,s[o?"acrossClue":"downClue"]=n,s[o?"acrossClueLetterIndex":"downClueLetterIndex"]=e,n.cells.push(s),n.hints.length>0&&-1!=n.hints.indexOf(e+1)&&(s.hint=!0),o?h++:l++}}}buildMatrix(){let e=this.width,i=this.height,t=[];for(let r=0;r<i;r++){let i=[];for(let t=0;t<e;t++)i[t]=new s({crossword:this,x:t,y:r});t[r]=i}return t}toString(){let e="",s=this.matrix;for(let i=0,t=s.length;i<t;i++){let t=s[i];e+="\n";for(let s=0,i=t.length;s<i;s++){let i=t[s];e+=i.answer||" "}}return e}}e.CrosswordCell=s,e.CrosswordClueDefinition=i,e.CrosswordDefinition=t,Object.defineProperty(e,"__esModule",{value:!0})});
